# ruta: rasa/domain_parts/domain_encuesta.yml
version: "3.1"

intents:
  - iniciar_encuesta
  - problema_resuelto_si
  - encuesta_satis_yes
  - encuesta_satis_no
  - respuesta_satisfecho
  - respuesta_insatisfecho
  - dar_retroalimentacion
  - continuar_consulta
  - terminar_conversacion
  - ir_menu_principal
  - contactar_tutor
  - continuar_tema_si
  - continue
  - affirm
  - deny

entities:
  - satisfaccion
  - comentario
  - feedback_texto
  - nivel_satisfaccion

slots:
  satisfaccion:
    type: text
    influence_conversation: true
    initial_value: null

  comentario:
    type: text
    influence_conversation: false

  feedback_texto:
    type: text
    influence_conversation: false
    initial_value: null

  nivel_satisfaccion:
    type: text
    influence_conversation: true
  
  encuesta_tipo:
    type: text
    influence_conversation: true

  usuario:
    type: text
    influence_conversation: false

responses:

  # --- Inicio de encuesta ---
  utter_preguntar_satisfaccion:
    - text: "ğŸ“Š Antes de finalizar, Â¿cÃ³mo calificarÃ­as tu experiencia con Zajuna?"
      buttons:
        - title: "ğŸŒŸ Excelente"
          payload: "/respuesta_satisfecho{'nivel_satisfaccion': 'excelente'}"
        - title: "ğŸ™‚ Buena"
          payload: "/respuesta_satisfecho{'nivel_satisfaccion': 'buena'}"
        - title: "ğŸ˜ Regular"
          payload: "/respuesta_insatisfecho{'nivel_satisfaccion': 'regular'}"
        - title: "ğŸ˜ Mala"
          payload: "/respuesta_insatisfecho{'nivel_satisfaccion': 'mala'}"

  # --- Encuesta positiva ---
  utter_agradecer_satisfaccion:
    - text: "Â¡Nos alegra que tu experiencia haya sido positiva! ğŸ’š"
    - text: "Â¿Deseas dejar un comentario adicional o volver al menÃº?"
      buttons:
        - title: "ğŸ—’ï¸ Dejar comentario"
          payload: "/dar_retroalimentacion"
        - title: "ğŸ  Volver al menÃº principal"
          payload: "/ir_menu_principal"

  utter_pedir_retroalimentacion:
    - text: "Por favor, cuÃ©ntanos brevemente quÃ© te gustÃ³ o quÃ© podrÃ­amos mejorar âœï¸"

  utter_gracias_retroalimentacion:
    - text: "ğŸ™ Â¡Gracias por tu comentario! Lo tendremos muy en cuenta."
    - text: "Â¿Deseas continuar con otra consulta o finalizar la conversaciÃ³n?"
      buttons:
        - title: "ğŸ  Volver al menÃº principal"
          payload: "/ir_menu_principal"
        - title: "ğŸ‘‹ Terminar conversaciÃ³n"
          payload: "/terminar_conversacion"

  # --- Encuesta negativa ---
  utter_lamentar_insatisfaccion:
    - text: "Lamentamos que tu experiencia no haya sido la mejor ğŸ˜"
    - text: "Â¿Deseas contactar a tu tutor para asistencia adicional?"
      buttons:
        - title: "âœ‰ï¸ Contactar tutor"
          payload: "/contactar_tutor"
        - title: "ğŸ  Volver al menÃº principal"
          payload: "/ir_menu_principal"

  # Alias usados por reglas/historias
  utter_agradecimiento_satisfaccion:
    - text: "Gracias por completar la encuesta ğŸ™ Tu opiniÃ³n nos ayuda a mejorar cada dÃ­a."

  utter_encuesta_insatisfaccion:
    - text: "Gracias por contarnos. Puedo derivarte a un tutor o dejar registro. Â¿QuÃ© prefieres?"
      buttons:
        - title: "Derivar a tutor"
          payload: "/contactar_tutor"
        - title: "Registrar y seguir"
          payload: "/continuar_consulta"

  # --- Continuar o finalizar ---
  utter_ofrecer_continuar:
    - text: "Â¿Deseas realizar otra consulta o volver al menÃº principal?"
      buttons:
        - title: "Volver al menÃº principal"
          payload: "/ir_menu_principal"
        - title: "Finalizar conversaciÃ³n"
          payload: "/terminar_conversacion"

  utter_despedida_final:
    - text: "âœ¨ Gracias por usar el Asistente Virtual Zajuna. Â¡Hasta pronto! ğŸ‘‹"

  utter_ofrecer_soporte:
    - text: "Lamento que no se haya resuelto tu solicitud. ğŸ˜ Â¿Deseas que te contacte un asesor humano para ayudarte?"

  utter_esta_resuelto:
    - text: "Â¿Pudimos resolver tu problema? (SÃ­ / No)"

  utter_encuesta_satisfaccion:
    - text: "Â¿CÃ³mo calificarÃ­as la atenciÃ³n recibida hoy? ğŸ˜Š\nOpciones: satisfecho / neutral / insatisfecho"

  utter_pedir_comentario:
    - text: "Â¿Deseas dejar un comentario adicional sobre tu experiencia?"

  utter_gracias_feedback:
    - text: "Â¡Gracias por compartir tu opiniÃ³n! ğŸ’¬ Valoramos mucho tus comentarios."

actions:
  - action_registrar_encuesta
  - action_guardar_feedback
  - action_ofrecer_continuar_tema
  - action_preguntar_resolucion
  - action_set_encuesta_tipo
  - validate_encuesta_satisfaccion_form

forms:
  feedback_form:
    required_slots:
      - feedback_texto

  encuesta_satisfaccion_form:
    required_slots:
      - nivel_satisfaccion
      - comentario
