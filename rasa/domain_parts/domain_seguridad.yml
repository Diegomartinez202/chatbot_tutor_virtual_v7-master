version: "3.1"

intents:
  - terminar_conversacion_segura
  - confirmar_cierre_segura
  - cancelar_cierre_segura
  - ir_menu_principal

slots:
  encuesta_activa:
    type: bool
    influence_conversation: true
    initial_value: false

responses:
  # ConfirmaciÃ³n de cierre seguro (la usa ActionVerificarEstadoEncuesta)
  utter_confirmar_cierre:
    - text: "Tienes una encuesta o proceso activo. Â¿Deseas cerrar la conversaciÃ³n y guardar tu progreso?"
      buttons:
        - title: "âœ… SÃ­, cerrar y guardar"
          payload: "/confirmar_cierre_segura"
        - title: "â†©ï¸ No, continuar"
          payload: "/cancelar_cierre_segura"

  # Cierre confirmado (la usa ActionVerificarEstadoEncuesta y ActionTerminarConversacionSegura)
  utter_cierre_confirmado:
    - text: "âœ… ConversaciÃ³n finalizada de forma segura. Â¡Gracias por usar el asistente Zajuna! ğŸŒŸ"

  # Mensaje mientras se guarda el progreso (la usa ActionGuardarProgresoEncuesta)
  utter_guardando_progreso:
    - text: "ğŸ’¾ Guardando tu progreso antes de cerrar la conversaciÃ³nâ€¦"

  # MenÃº principal bÃ¡sico (lo usa ActionIrMenuPrincipal; si ya tienes uno, puedes borrar este bloque)
  utter_menu_principal:
    - text: "ğŸ  Volvemos al menÃº principal. Â¿QuÃ© deseas hacer ahora?"
      buttons:
        - title: "ğŸ“ Ver estado acadÃ©mico"
          payload: "/ver_estado_estudiante"
        - title: "ğŸ“œ Consultar certificados"
          payload: "/consultar_certificados"
        - title: "ğŸ› ï¸ Soporte"
          payload: "/solicitar_soporte"
        - title: "âŒ Terminar conversaciÃ³n"
          payload: "/terminar_conversacion_segura"

actions:
  - action_verificar_estado_encuesta
  - action_guardar_progreso_encuesta
  - action_terminar_conversacion_segura
  - action_ir_menu_principal
