# ruta: rasa/domain_parts/domain_cierre_conversacion.yml
version: "3.1"

intents:
  - terminar_conversacion
  - confirmar_cierre
  - cancelar_cierre
  - despedida
  - nlu_fallback

slots:
  encuesta_activa:
    type: bool
    influence_conversation: true
    initial_value: false

responses:
  utter_confirmar_cierre:
    - text: "Â¿Deseas finalizar la conversaciÃ³n ahora?"
      buttons:
        - title: "âœ… SÃ­, finalizar"
          payload: "/confirmar_cierre"
        - title: "â†©ï¸ No, continuar"
          payload: "/cancelar_cierre"

  utter_cierre_confirmado:
    - text: "âœ… ConversaciÃ³n finalizada. Â¡Gracias por usar el asistente Zajuna! ğŸŒŸ"
      buttons:
        - title: "ğŸ” Volver al menÃº"
          payload: "/ir_menu_principal"

  utter_cierre_cancelado:
    - text: "ğŸ‘Œ Perfecto, seguimos aquÃ­. Â¿En quÃ© mÃ¡s puedo ayudarte?"
      buttons:
        - title: "ğŸ  MenÃº principal"
          payload: "/ir_menu_principal"
        - title: "ğŸ“„ Ver certificados"
          payload: "/consultar_certificados"
        - title: "ğŸ“Š Estado acadÃ©mico"
          payload: "/ver_estado_estudiante"

  utter_despedida_profesional:
    - text: "ğŸ‘‹ Gracias por usar el asistente Zajuna. Â¡Que tengas un excelente dÃ­a! ğŸŒŸ"
      buttons:
        - title: "ğŸ” Reabrir menÃº"
          payload: "/ir_menu_principal"
        - title: "ğŸ” Reanudar mÃ¡s tarde"
          payload: "/terminar_conversacion"

  utter_fallback:
    - text: "ğŸ¤” No entendÃ­ bien. Â¿Quieres intentarlo con otra frase o volver al menÃº?"
      buttons:
        - title: "ğŸ  MenÃº principal"
          payload: "/ir_menu_principal"
        - title: "ğŸ†˜ Hablar con soporte"
          payload: "/solicitar_soporte"

  utter_cerrar_chat:
    - text: "âœ… ConversaciÃ³n finalizada. Cuando quieras, vuelve a escribirme."

  # Agregada para evitar warnings cuando las acciones la llaman
  utter_volver_menu:
    - text: "ğŸ“‹ Este es el menÃº principal. Â¿QuÃ© deseas hacer?"
      buttons:
        - title: "ğŸ“Š Estado acadÃ©mico"
          payload: "/ver_estado_estudiante"
        - title: "ğŸ“„ Certificados"
          payload: "/consultar_certificados"
        - title: "ğŸ› ï¸ Soporte"
          payload: "/solicitar_soporte"

actions:
  - action_confirmar_cierre
  - action_finalizar_conversacion
  - action_cancelar_cierre
