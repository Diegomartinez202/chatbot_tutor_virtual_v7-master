# ruta: rasa/domain_parts/domain_conversacion_segura.yml
version: "3.1"

intents:
  - terminar_conversacion_segura
  - confirmar_cierre
  - cancelar_cierre
  - reanudar_conversacion
  - limpiar_autosave

entities:
  - autosave_estado

slots:
  autosave_estado:
    type: text
    influence_conversation: true
  encuesta_activa:
    type: bool
    initial_value: false
    influence_conversation: true
  encuesta_tipo:
    type: text
    influence_conversation: true

responses:
  utter_confirmar_cierre:
    - text: "Parece que tienes una encuesta activa o informaciÃ³n sin guardar. Â¿Deseas cerrar de todas formas?"
      buttons:
        - title: "âœ… SÃ­, cerrar y guardar"
          payload: "/confirmar_cierre"
        - title: "â†©ï¸ No, continuar"
          payload: "/cancelar_cierre"

  utter_cierre_confirmado:
    - text: "Perfecto. Se cerrarÃ¡ la sesiÃ³n y se guardarÃ¡ tu progreso actual."

  utter_cierre_cancelado:
    - text: "Entendido, seguimos donde estabas. ğŸ˜Š"

  utter_reanudar_conversacion:
    - text: "Parece que tenÃ­as una encuesta pendiente. Â¿Deseas continuarla?"

  utter_limpiar_autosave:
    - text: "Los datos temporales fueron limpiados correctamente."

actions:
  - action_confirmar_cierre_seguro
  - action_autosave_encuesta
  - action_guardar_autosave_mongo
  - action_cargar_autosave_mongo
  - action_autoresume_conversacion
  - action_reset_conversacion_segura
