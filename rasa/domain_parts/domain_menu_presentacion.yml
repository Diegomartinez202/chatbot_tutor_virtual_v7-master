version: "3.1"

# Declaramos los intents que se invocan desde los botones de este menÃº
intents:
  - ver_estado_estudiante
  - consultar_certificados
  - solicitar_soporte
  - auth_login_cmd
  - terminar_conversacion
  - ir_menu_principal
  - recuperar_contrasena

responses:
  # ===== MenÃº principal (QUICK REPLIES) =====
  utter_menu_principal_quick:
    # Fallback universal (botones estÃ¡ndar)
    - text: "Elige una opciÃ³n para continuar:"
      buttons:
        - title: "ğŸ“ Estado acadÃ©mico"
          payload: "/ver_estado_estudiante"
        - title: "ğŸ“œ Certificados"
          payload: "/consultar_certificados"
        - title: "ğŸ› ï¸ Soporte"
          payload: "/solicitar_soporte"
        - title: "ğŸ” Iniciar sesiÃ³n"
          payload: "/auth_login_cmd"
        - title: "âŒ Terminar"
          payload: "/terminar_conversacion"

    # Variante Socket.IO
    - channel: "socketio"
      text: "ğŸ‘‡ Opciones rÃ¡pidas:"
      buttons:
        - title: "ğŸ“ Estado"
          payload: "/ver_estado_estudiante"
        - title: "ğŸ“œ Certificados"
          payload: "/consultar_certificados"
        - title: "ğŸ” Login"
          payload: "/auth_login_cmd"
        - title: "âŒ Terminar"
          payload: "/terminar_conversacion"

    # Variante Facebook Messenger (quick_replies nativos)
    - channel: "facebook"
      custom:
        text: "Selecciona una opciÃ³n:"
        quick_replies:
          - content_type: "text"
            title: "ğŸ“ Estado"
            payload: "/ver_estado_estudiante"
          - content_type: "text"
            title: "ğŸ“œ Certificados"
            payload: "/consultar_certificados"
          - content_type: "text"
            title: "ğŸ” Login"
            payload: "/auth_login_cmd"
          - content_type: "text"
            title: "âŒ Terminar"
            payload: "/terminar_conversacion"

  # ===== Listado de certificados (CAROUSEL / Fallback) =====
  utter_certificados_carousel:
    # Fallback universal (Markdown + botones)
    - text: |
        ğŸ“œ **Tus certificados disponibles**
        1) *IntroducciÃ³n a ProgramaciÃ³n* â€” 2024-06-10  
           â€¢ [Ver PDF](https://zajuna.sena.edu.co/cert/123)  
           â€¢ [Descargar](https://zajuna.sena.edu.co/cert/123/download)

        2) *Bases de Datos* â€” 2025-03-15  
           â€¢ [Ver PDF](https://zajuna.sena.edu.co/cert/456)  
           â€¢ [Descargar](https://zajuna.sena.edu.co/cert/456/download)
      buttons:
        - title: "ğŸ” Iniciar sesiÃ³n Zajuna"
          payload: "/auth_login_cmd"
        - title: "ğŸ  MenÃº principal"
          payload: "/ir_menu_principal"

    # Variante Socket.IO
    - channel: "socketio"
      text: |
        ğŸ“œ Certificados:
        â€¢ IntroducciÃ³n a ProgramaciÃ³n (2024-06-10)  
          Ver: https://zajuna.sena.edu.co/cert/123  
          Descargar: https://zajuna.sena.edu.co/cert/123/download

        â€¢ Bases de Datos (2025-03-15)  
          Ver: https://zajuna.sena.edu.co/cert/456  
          Descargar: https://zajuna.sena.edu.co/cert/456/download
      buttons:
        - title: "ğŸ” Login"
          payload: "/auth_login_cmd"
        - title: "ğŸ  MenÃº"
          payload: "/ir_menu_principal"

    # Facebook Messenger: carrusel nativo (generic template)
    - channel: "facebook"
      custom:
        attachment:
          type: "template"
          payload:
            template_type: "generic"
            elements:
              - title: "IntroducciÃ³n a ProgramaciÃ³n"
                subtitle: "Emitido: 2024-06-10"
                image_url: "https://tu-cdn/certificados/programacion.png"
                buttons:
                  - type: "web_url"
                    url: "https://zajuna.sena.edu.co/cert/123"
                    title: "Ver PDF"
                  - type: "web_url"
                    url: "https://zajuna.sena.edu.co/cert/123/download"
                    title: "Descargar"
              - title: "Bases de Datos"
                subtitle: "Emitido: 2025-03-15"
                image_url: "https://tu-cdn/certificados/bd.png"
                buttons:
                  - type: "web_url"
                    url: "https://zajuna.sena.edu.co/cert/456"
                    title: "Ver PDF"
                  - type: "web_url"
                    url: "https://zajuna.sena.edu.co/cert/456/download"
                    title: "Descargar"

  # ===== Hint de Login (CTA) =====
  utter_login_hint:
    - text: |
        ğŸ” Para ver tus datos en tiempo real, inicia sesiÃ³n en Zajuna:
        1) ğŸ“² Abre: https://zajuna.sena.edu.co/login
        2) â–¶ï¸ Ingresa tus credenciales
        3) ğŸ” Vuelve aquÃ­ (el bot detectarÃ¡ tu sesiÃ³n)
      buttons:
        - title: "Abrir Zajuna"
          payload: "/auth_login_cmd"
        - title: "Â¿OlvidÃ© mi contraseÃ±a?"
          payload: "/recuperar_contrasena"
