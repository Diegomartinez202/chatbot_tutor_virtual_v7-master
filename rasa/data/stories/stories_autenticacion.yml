version: "3.1"

stories:
- story: Login exitoso
  steps:
  - intent: iniciar_sesion
  - action: action_ingreso_zajuna
  - intent: enviar_credenciales
  - action: action_set_authenticated_true
  - action: utter_bienvenida
  - slot_was_set:
      - is_authenticated: true

- story: Recuperación de contraseña
  steps:
  - intent: recuperar_contrasena
  - action: action_recuperar_contrasena
  - intent: enviar_email_recuperacion
  - action: action_enviar_correo
  - action: utter_confirmacion_recuperacion

- story: Intentar acceder a acción protegida sin autenticación
  steps:
  - intent: estado_estudiante
  - action: action_check_auth
  - action: utter_need_auth
  - intent: confirmar_autenticacion
  - action: action_ingreso_zajuna
  - intent: enviar_credenciales
  - action: action_set_authenticated_true
  - action: action_estado_estudiante

- story: Acceso a certificados protegido
  steps:
  - intent: ver_certificados
  - action: action_check_auth
  - action: utter_need_auth
  - intent: confirmar_autenticacion
  - action: action_ingreso_zajuna
  - intent: enviar_credenciales
  - action: action_set_authenticated_true
  - action: action_ver_certificados

- story: Soporte avanzado con encuesta
  steps:
  - intent: solicitar_soporte
  - action: action_ofrecer_continuar_tema
  - intent: affirm
  - action: action_enviar_soporte
  - action: action_soporte_submit
  - action: action_preguntar_resolucion
  - intent: affirm
  - action: action_registrar_encuesta
  - action: utter_agradecimiento_encuesta

- story: Escalar a humano
  steps:
  - intent: necesita_humano
  - action: action_derivar_y_registrar_humano
  - action: action_conectar_humano
  - action: utter_espera_agente

- story: Fallback dinámico
  steps:
  - intent: fallback
  - action: utter_fallback
