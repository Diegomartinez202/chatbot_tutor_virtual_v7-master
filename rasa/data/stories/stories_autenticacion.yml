# ruta: rasa/data/stories/stories_autenticacion.yml
version: "3.1"

stories:

- story: Login exitoso por formulario
  steps:
    - intent: enviar_credenciales
    - action: auth_login_form
    - active_loop: auth_login_form
    - action: auth_login_form
    - active_loop: null
    - action: action_ingreso_zajuna
    - action: action_set_authenticated_true
    - action: utter_auth_ok

- story: Intentar acción protegida sin autenticación
  steps:
    - intent: estado_estudiante
    - action: action_check_auth
    - action: utter_need_auth
    - intent: confirmar_autenticacion
    - action: action_set_authenticated_true
    - action: action_estado_estudiante

- story: Recuperación de contraseña
  steps:
    - intent: recuperar_contrasena
    - action: password_recovery_form
    - active_loop: password_recovery_form
    - action: password_recovery_form
    - active_loop: null
    - action: action_recuperar_contrasena
    - action: action_enviar_correo_recuperacion
    - action: utter_recuperacion_enviada

- story: Soporte rápido con afirmación
  steps:
    - intent: solicitar_soporte
    - action: utter_ofrecer_continuar
    - intent: affirm
    - action: action_enviar_soporte

- story: Escalar a humano
  steps:
    - intent: necesita_humano
    - action: action_derivar_y_registrar_humano
    - action: action_conectar_humano
    - action: utter_espera_agente

- story: Fallback simple
  steps:
    - intent: fallback
    - action: utter_fallback
