version: "3.1"

stories:
  - story: Soporte con dos fallbacks y completar
    steps:
      - intent: escalar_humano
      - action: utter_ofrecer_humano
      - intent: affirm
      - action: utter_handoff_iniciado
      - action: soporte_form
      - active_loop: soporte_form

      # 1er fallback dentro del form
      - intent: nlu_fallback
      - action: action_registrar_intento_form
      - action: action_verificar_max_intentos_form
      - action: utter_form_fallback_warn
      - action: soporte_form
      - active_loop: soporte_form

      # 2º fallback dentro del form
      - intent: nlu_fallback
      - action: action_registrar_intento_form
      - action: action_verificar_max_intentos_form
      - action: utter_form_fallback_warn
      - action: soporte_form
      - active_loop: soporte_form

      # El 3er fallback se manejará ya con la rule que deriva a humano
