version: "3.1"

stories:

  - story: Cierre seguro con encuesta activa
    steps:
      - intent: terminar_conversacion_segura
      - action: action_verificar_estado_encuesta
      # Aquí el bot muestra utter_confirmar_cierre si encuesta_activa == True
      - intent: confirmar_cierre_segura
      - action: action_guardar_progreso_encuesta
      - action: action_terminar_conversacion_segura

  - story: Cierre seguro cancelado
    steps:
      - intent: terminar_conversacion_segura
      - action: action_verificar_estado_encuesta
      # El usuario decide no cerrar
      - intent: cancelar_cierre_segura
      - action: action_ir_menu_principal

  - story: Cierre seguro sin encuesta activa
    steps:
      # Simulamos que no hay encuesta activa
      - slot_was_set:
          - encuesta_activa: false
      - intent: terminar_conversacion_segura
      - action: action_verificar_estado_encuesta
      # En este caso la acción mostrará directamente utter_cierre_confirmado

