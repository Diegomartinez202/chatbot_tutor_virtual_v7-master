version: "3.1"
stories:

  # 0) Entrada com√∫n (Saludo ‚Üí Men√∫ principal)
  - story: Entrada principal (saludo ‚Üí men√∫)
    steps:
     - intent: saludo
     - action: utter_saludo          
     - action: utter_saludo_menu     

  # ==============================
  # BLOQUE: ADMINISTRATIVAS/ACAD√âMICAS
  # ==============================

  - story: Men√∫ acad√©mico jer√°rquico (secundario)
    steps:
      - intent: proceso_academico
      - action: utter_menu_proceso_academico
      - action: action_preguntar_resolucion

  - story: Estado estudiante (autenticado)
    steps:
    - slot_was_set:
        - is_authenticated: true
    - intent: ver_estado_estudiante_info
    - action: action_estado_estudiante
    - action: utter_estado_estudiante      # üëà a√±adir este utter
    - action: action_preguntar_resolucion  # üëà ahora s√≠

  # 3) Estado de estudiante (NO AUTENTICADO)
  - story: Estado estudiante (no autenticado)
    steps:
      - intent: proceso_academico
      - action: utter_menu_academico
      - slot_was_set:
          - is_authenticated: false
      - intent: ver_estado_estudiante_info
      - action: utter_instrucciones_estado
      - action: utter_need_auth
      - action: action_preguntar_resolucion

  # 4) Certificados (AUTENTICADO)
  - story: Certificados (autenticado)
    steps:
      - intent: proceso_academico
      - action: utter_menu_academico
      - slot_was_set:
          - is_authenticated: true
      - intent: ver_certificados_info
      - action: action_listar_certificados
      - action: utter_ver_certificados
      - action: action_preguntar_resolucion

  # 5) Certificados (NO AUTENTICADO)
  - story: Certificados (no autenticado)
    steps:
      - intent: proceso_academico
      - action: utter_menu_academico
      - slot_was_set:
          - is_authenticated: false
      - intent: ver_certificados_info
      - action: utter_instrucciones_certificados
      - action: utter_need_auth
      - action: action_preguntar_resolucion

  # 6) Tutor asignado (AUTENTICADO)
  - story: Tutor asignado (autenticado)
    steps:
      - intent: proceso_academico
      - action: utter_menu_academico
      - slot_was_set:
          - is_authenticated: true
      - intent: ver_tutor_asignado_info
      - action: action_tutor_asignado
      - action: utter_tutor_asignado_info
      - action: action_preguntar_resolucion

  # 7) Tutor asignado (NO AUTENTICADO)
  - story: Tutor asignado (no autenticado)
    steps:
      - intent: proceso_academico
      - action: utter_menu_academico
      - slot_was_set:
          - is_authenticated: false
      - intent: ver_tutor_asignado_info
      - action: utter_instrucciones_tutor
      - action: utter_need_auth
      - action: action_preguntar_resolucion

  # ==============================
  # BLOQUE: SOPORTE T√âCNICO
  # ==============================

  - story: Soporte t√©cnico (formulario)
    steps:
    - intent: enviar_soporte          # üëà NO 'soporte_tecnico'
    - action: soporte_form
    - active_loop: soporte_form
    - action: action_soporte_submit   # üëà al cerrar el form
    - action: action_preguntar_resolucion


  # 9) Soporte AVA directo (gu√≠a inmediata)
  - story: Soporte AVA (directo)
    steps:
      - intent: soporte_ava_directo
      - action: utter_soporte_ava
      - action: action_preguntar_resolucion

  # ==============================
  # BLOQUE: EXPLORAR / CAT√ÅLOGO (opcional recomendado)
  # ==============================

  # 10) Explorar cursos (recomendados + carrusel)
  - story: Explorar temas (recomendados + carrusel)
    steps:
      - intent: explorar_temas
      - action: utter_cursos_recomendados
      - action: utter_cursos_carousel
      - action: action_preguntar_resolucion
 
  - story: Cobertura utilitarios y encuesta (no-interferente)
    steps:
     
      - intent: encuesta_satis_yes
      - action: action_registrar_encuesta
      - action: utter_gracias_feedback

      - intent: encuesta_satis_no
      - action: action_registrar_encuesta
      - action: utter_gracias_feedback

      - intent: enviar_correo
      - action: action_enviar_correo
      - action: utter_enviar_correo

      - intent: enviar_telefono
      - action: utter_enviar_telefono

      - intent: enviar_cedula
      - action: utter_enviar_cedula

      - intent: enviar_url
      - action: utter_enviar_url

      - intent: pedir_correo
      - action: utter_ask_email

      - intent: pedir_email
      - action: utter_ask_email

      - intent: pedir_nombre
      - action: utter_ask_nombre

      - intent: pedir_mensaje
      - action: utter_ask_mensaje

      - intent: recuperar_contrasena
      - action: recovery_form
      - active_loop: recovery_form

      - intent: ver_link_soporte
      - action: utter_link_soporte

      - intent: ver_soporte_creado_info
      - action: utter_soporte_creado

      - intent: negar_escalar
      - action: utter_gracias_continuar
  
  - story: Validaci√≥n acad√©mica ‚Äî intents heredados
    steps:
      - action: utter_instrucciones_estado
      - action: action_preguntar_resolucion
      - action: utter_instrucciones_tutor
      - action: action_preguntar_resolucion
      - action: utter_instrucciones_certificados
      - action: utter_certificados_info
      - action: action_preguntar_resolucion

  - story: Validaci√≥n de respuestas informativas
    steps:
 
  - story: Confirmaci√≥n de resoluci√≥n m√≠nima
    steps:
      - action: action_preguntar_resolucion
      - intent: problema_resuelto_si
      - action: utter_encuesta_satisfaccion