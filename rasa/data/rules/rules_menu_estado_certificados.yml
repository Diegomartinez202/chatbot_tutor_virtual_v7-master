#\rasa\data\rules\rules_menu_estado_certificados.yml
version: "3.1"
rules:

  # ============ ESTADO ACADÉMICO ============

  - rule: Ver estado estudiante (autenticado) - intent ver_estado_estudiante
    steps:
      - intent: ver_estado_estudiante
      - slot_was_set:
          - is_authenticated: true
      - action: action_ver_estado_estudiante

  - rule: Ver estado estudiante (no autenticado) - intent ver_estado_estudiante
    steps:
      - intent: ver_estado_estudiante
      - slot_was_set:
          - is_authenticated: false
      - action: utter_login_requerido

  - rule: Ver estado estudiante (autenticado) - intent estado_estudiante
    steps:
      - intent: estado_estudiante
      - slot_was_set:
          - is_authenticated: true
      - action: action_ver_estado_estudiante

  - rule: Ver estado estudiante (no autenticado) - intent estado_estudiante
    steps:
      - intent: estado_estudiante
      - slot_was_set:
          - is_authenticated: false
      - action: utter_login_requerido

  # ============ CERTIFICADOS ============

  - rule: Consultar certificados (autenticado)
    condition:
      - slot_was_set:
          - is_authenticated: true
    steps:
      - intent: consultar_certificados
      - action: action_consultar_certificados

  - rule: Consultar certificados (no autenticado)
    condition:
      - slot_was_set:
          - is_authenticated: false
    steps:
      - intent: consultar_certificados
      - action: utter_login_hint
  
  - rule: Consultar certificados (autenticado)
    steps:
      - intent: consultar_certificados
      - action: utter_certificados_carousel

  # ============ MENÚ PRINCIPAL ============

  - rule: Mostrar menú principal al saludo
    steps:
      - intent: saludo
      - action: utter_menu_principal
   # === Helpers de login / recuperación ===
  - rule: Mostrar guía de login (deep-links)
    steps:
      - intent: ver_login_hint
      - action: utter_login_hint

  - rule: Mostrar CTA de recuperación de contraseña
    steps:
      - intent: recuperar_contrasena
      - action: utter_recuperar_acceso_cta
  
