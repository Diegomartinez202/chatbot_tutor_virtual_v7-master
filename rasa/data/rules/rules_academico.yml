# ruta: rasa/data/rules/rules_academico.yml
version: "3.1"

rules:

  # ===== CERTIFICADOS =====
  - rule: Consultar certificados (autenticado)
    condition:
      - slot_was_set:
          - is_authenticated: true
    steps:
      - intent: consultar_certificados
      - action: action_listar_certificados
      - action: utter_preguntar_continuar_menu

  - rule: Consultar certificados (no autenticado)
    condition:
      - slot_was_set:
          - is_authenticated: false
    steps:
      - intent: consultar_certificados
      - action: utter_pedir_autenticacion

  # ===== ESTADO ACADÉMICO =====
  - rule: Ver estado (autenticado)
    condition:
      - slot_was_set:
          - is_authenticated: true
    steps:
      - intent: ver_estado_estudiante
      - action: action_estado_estudiante
      - action: utter_preguntar_continuar_menu

  - rule: Ver estado (no autenticado)
    condition:
      - slot_was_set:
          - is_authenticated: false
    steps:
      - intent: ver_estado_estudiante
      - action: utter_pedir_autenticacion

  # ===== MENÚ =====
  - rule: Volver al menú principal
    steps:
      - intent: ir_menu_principal
      - action: utter_menu_principal

  # ===== CIERRE CANÓNICO =====
  - rule: Confirmar y finalizar conversación
    steps:
      - intent: terminar_conversacion
      - action: utter_confirmar_cierre
